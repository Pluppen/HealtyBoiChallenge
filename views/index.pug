html
    head
        title= title
        link(rel="stylesheet", type="text/css", href="/main.css")
        link(href="https://fonts.googleapis.com/css?family=Press+Start+2P", rel="stylesheet")
        link(href="https://unpkg.com/nes.css/css/nes.css", rel="stylesheet")
        script(type="x-shader/x-vertex" id="vertex-shader").
          #version 100
          precision highp float;

          uniform float time;
          attribute vec2 pos;

          void main() {
            float speed = 1.5;
            //gl_Position = vec4(pos.x*(cos(time*speed)*0.5+0.5), pos.y*(sin(time*speed)*0.5+0.5), 0.0, 1.0);
            gl_Position = vec4(pos, 0, 1.0);
            gl_PointSize = 64.0;
          }

        script(type="x-shader/x-fragment" id="fragment-shader").
          #version 100
          precision mediump float;

          uniform float time;
          uniform vec2 res;

          void main() {
            vec2 p = gl_FragCoord.xy / res;
            p = p * 2.0 - 1.0;
            float d = length(p);
            float dSq = d*d;
            gl_FragColor = vec4(
              (cos(time*0.8)*0.5+0.5)*(0.2/d),
              0.1/dSq,
              0.0,
              1.0
            );
          }

        script.
          window.addEventListener("load", setupWebGL, false);

          function getRenderingContext() {
            const canvas = document.querySelector("canvas");
            canvas.width = canvas.clientWidth;
            canvas.height = canvas.clientHeight;
            const gl =
              canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
            if (!gl) {
              const paragraph = document.querySelector("p");
              paragraph.textContent =
                "Failed to get WebGL context. Your browser or device may not support WebGL.";
              return null;
            }
            gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);
            gl.clearColor(0.0, 0.0, 0.0, 1.0);
            gl.clear(gl.COLOR_BUFFER_BIT);
            return gl;
          }

          let gl;
          let program;

          function setupWebGL(ev) {
            window.removeEventListener(ev.type, setupWebGL, false);
            if (!(gl = getRenderingContext())) return;

            let source = document.querySelector("#vertex-shader").innerHTML;
            const vertexShader = gl.createShader(gl.VERTEX_SHADER);
            gl.shaderSource(vertexShader, source);
            gl.compileShader(vertexShader);

            source = document.querySelector("#fragment-shader").innerHTML;
            const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
            gl.shaderSource(fragmentShader, source);
            gl.compileShader(fragmentShader);

            program = gl.createProgram();
            gl.attachShader(program, vertexShader);
            gl.attachShader(program, fragmentShader);
            gl.linkProgram(program);
            gl.detachShader(program, vertexShader);
            gl.detachShader(program, fragmentShader);
            gl.deleteShader(vertexShader);
            gl.deleteShader(fragmentShader);
            if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
              const linkErrorLog = gl.getProgramInfoLog(program);
              cleanup();
              console.error(`Shader program did not link successfully. Error: ${linkErrorLog}`);
              return;
            }

            gl.useProgram(program);
            initializeAttributes();

            gl.drawArrays(gl.TRIANGLES, 0, 6);

            const start = Date.now();
            setInterval(() => {
              const time = (Date.now() - start)/1000;
              gl.uniform1f(program.time, time);

              gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
              gl.enableVertexAttribArray(program.pos);
              gl.vertexAttribPointer(program.pos, 2, gl.FLOAT, false, 0, 0);
              gl.drawArrays(gl.TRIANGLES, 0, 6);
            }, 10);
          }

          let vertexBuffer;
          function initializeAttributes() {
            const aspect = 194/182;
            const size = 1;
            const vertices = new Float32Array([
              -size, size*aspect, size, size*aspect, size, -size*aspect,
              -size, size*aspect, size, -size*aspect, -size, -size*aspect,
            ]);

            vertexBuffer = gl.createBuffer();
            gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
            gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);

            program.pos = gl.getAttribLocation(program, "pos");
            gl.enableVertexAttribArray(program.pos);
            gl.vertexAttribPointer(program.pos, 2, gl.FLOAT, false, 0, 0);

            program.time = gl.getUniformLocation(program, "time");
            gl.uniform1f(program.time, 0);

            program.res = gl.getUniformLocation(program, "res");
            gl.uniform2f(program.res, gl.canvas.width, gl.canvas.height);
          }

          window.addEventListener("beforeunload", cleanup, true);
          function cleanup() {
            gl.useProgram(null);
            if (vertexBuffer) {
              gl.deleteBuffer(vertexBuffer);
            }
            if (timeBuffer) {
              gl.deleteBuffer(timeBuffer);
            }

            if (program) {
              gl.deleteProgram(program);
            }
          }
    body
        h1=" HealtyBoi Challenge"
        div(class="container")
            each player in players
                form(class="card", method="POST")
                    if player.useShaderForProfilePicture
                        canvas(class="profile-picture-canvas" id=player.id)
                    else
                        img(src="data:image/jpeg;base64,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")
                    div(class="heart")
                    h2 #{player.name}
                    h3 #{player.xp}
                    input(name="id", value=player.id, hidden)
                    button +

